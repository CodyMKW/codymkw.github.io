<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta name="msapplication-TileColor" content="#00c900">
    <meta name="theme-color" content="#00c900">
    <link href="https://social.vivaldi.net/@codymkw" rel="me">
    <meta name="description" content="Countdown to events and build up some hype as you wait.">
    <meta name="keywords" content="CodyMKW, Nintendo fan, Animal Crossing, Nintendo Switch, Mario Kart, Pok√©mon, gaming enthusiast, peaceful gaming, relaxing atmosphere, gaming community, Nintendo Switch gaming, gaming adventures, video games, Nintendo games, gaming journey, social media, gaming community, anime, Clannad, future of Nintendo, QR code, Nintendo news, web apps, social links, gaming fun, Friend Code, gaming enthusiast, gaming community.">
    <meta name="author" content="CodyMKW">
    <meta property="og:title" content="Countdown ‚Äì CodyMKW">
    <meta property="og:description" content="A countdown for hyping up upcoming events like game releases and anime debuts.">
    <meta property="og:image" content="https://www.gravatar.com/avatar/5127de8a3a295a02ff3fc55bb6b2fabe?s=2048">
    <meta property="og:url" content="https://codymkw.github.io">
    <meta property="og:type" content="website">
    <meta name="twitter:creator" content="@CodyMKW" />
    <meta name="twitter:title" content="Countdown ‚Äì CodyMKW" />
    <meta name="twitter:description" content="A countdown for hyping up upcoming events like game releases and anime debuts." />
    <meta name="twitter:image:src" content="https://www.gravatar.com/avatar/5127de8a3a295a02ff3fc55bb6b2fabe?s=2048" />
    <link id="theme-style" rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/emoji.css">
    <script defer src="assets/javascript/main.js"></script>
    <script defer src="assets/javascript/stickyheader.js"></script>
    <title>Countdown ‚Äì CodyMKW</title>
</head>

<body>
<div id="sticky-header" class="sticky-header" style="display: none;">
    <span id="close-button" onclick="toggleHeader()">X</span>
    <a href="" target="_blank" class="important"></a>
</div>

<div class="container">
<div class="header">
<div id="cody-header-bg">
<h1 id="cody-heading2"></h1>
<h1 id="cody-heading"></h1>
</div>
<p><img id="site-title-image" src="assets/images/Site_Title(dark).png" alt="Site Tite" style="width:800px;max-width:100%;border-radius:0;transform:translateX(-10px);"></p>
<div class="header-text">
<p>üéÆ A gamer that likes Nintendo and anime üç•</p>
<div id="status-container"></div>
</div>
</div>

<div class="tabs">
<button onclick="window.location.href='/'">About</button>
<button onclick="window.location.href='blog'">Blog</button>
<button onclick="window.location.href='nintendo-news'">Nintendo News</button>
<button onclick="window.open('https://codymkw.atabook.org','_blank')">Guestbook</button>
<button onclick="window.location.href='other-stuff'">Other Stuff</button>
<button onclick="window.location.href='social-media'">Social Media</button>
</div>

<div class="content" id="countdownContent"></div>
</div>

<button id="theme-toggle" class="theme-toggle-button"><span>‚òÄÔ∏è</span> Light Mode</button>
<footer></footer>

<script>
const container = document.getElementById("countdownContent");

container.innerHTML = `
  <div class="countdown-tabs">
    <button id="tab-active" class="active">Active</button>
    <button id="tab-archived">Archived</button>
  </div>

  <div id="activeView">
    <div id="featured-warning" style="display:none;"></div>
    <div id="featuredCountdown"></div>
    <div id="activeCountdowns"></div>
  </div>

  <div id="archivedView" style="display:none;">
    <div id="archivedCountdowns"></div>
  </div>
`;

const featuredContainer = document.getElementById("featuredCountdown");
const activeContainer = document.getElementById("activeCountdowns");
const archiveContainer = document.getElementById("archivedCountdowns");

const activeView = document.getElementById("activeView");
const archivedView = document.getElementById("archivedView");
const tabActive = document.getElementById("tab-active");
const tabArchived = document.getElementById("tab-archived");

tabActive.onclick = () => {
  tabActive.classList.add("active");
  tabArchived.classList.remove("active");
  activeView.style.display = "block";
  archivedView.style.display = "none";
};

tabArchived.onclick = () => {
  tabArchived.classList.add("active");
  tabActive.classList.remove("active");
  activeView.style.display = "none";
  archivedView.style.display = "block";
};

fetch('https://api.npoint.io/2eabb77161bc45752e92')
  .then(response => response.json())
  .then(data => {
    const events = Array.isArray(data) ? data : [data];
    const featuredEvents = events.filter(e => e.featured);
    const warningBox = document.getElementById("featured-warning");

    if (featuredEvents.length > 1) {
      warningBox.style.display = "block";
      warningBox.innerHTML = `
        ‚ö†Ô∏è Featured Countdown Configuration Error ‚ö†Ô∏è<br><br>
        Cody, it looks like <b>${featuredEvents.length}</b> countdowns are marked as <b>featured</b>.<br><br>
        <b>Currently featured:</b><br>
        ${featuredEvents.map(e => "‚Ä¢ " + (e.title || "Untitled Countdown")).join("<br>")}<br><br>
        Only <b>one</b> featured countdown is supported at a time so it can be highlighted correctly.<br><br>
        Please review your JSON configuration and leave exactly one item marked as featured.
        <br><br>Cody, you doofus! Get your shit together and fix this dumbass mistake!  
        <br>If you're not Cody, please make sure to tell Cody about this mess.
      `;
    }

    events.forEach((event, index) => {
      const section = createCountdownMarkup(event, index);

      if (event.featured && featuredEvents.length === 1) {
        featuredContainer.appendChild(section);
        section.classList.add("featured");
      } else if (!event.featured) {
        activeContainer.appendChild(section);
      }

      startTimer(new Date(event.date).getTime(), index, section, event);
    });
  });

function createCountdownMarkup(event, index) {
  const section = document.createElement('div');
  section.className = 'countdown-section';
  section.style.marginBottom = "50px";

  section.innerHTML = `
    ${event.featured ? `<div class="featured-badge">FEATURED</div>` : ""}
    <h1 id="title-${index}">${event.title || 'Countdown'}</h1>
    <p id="desc-${index}">${event.description || ''}</p>
    <div class="countdown" id="timer-${index}">
      <div class="countdown-item"><h2 id="days-${index}">0</h2><p>Days</p></div>
      <div class="countdown-item"><h2 id="hours-${index}">0</h2><p>Hours</p></div>
      <div class="countdown-item"><h2 id="minutes-${index}">0</h2><p>Minutes</p></div>
      <div class="countdown-item"><h2 id="seconds-${index}">0</h2><p>Seconds</p></div>
    </div>
    <div id="finished-${index}" style="display:none;">
      ${event.finishedMessage || "Countdown Finished! üéâ"}
    </div>
    <hr style="border: 0; height: 1px; background: #333; margin-top: 40px; opacity: 0.2;">
  `;

  return section;
}

function startTimer(targetDate, index, section, event) {
  const daysEl = document.getElementById(`days-${index}`);
  const hoursEl = document.getElementById(`hours-${index}`);
  const minutesEl = document.getElementById(`minutes-${index}`);
  const secondsEl = document.getElementById(`seconds-${index}`);
  const timerEl = document.getElementById(`timer-${index}`);
  const finishedEl = document.getElementById(`finished-${index}`);

  function updateCountdown() {
    const now = new Date().getTime();
    const distance = targetDate - now;

    if (distance <= 0) {
      timerEl.style.display = "none";
      finishedEl.style.display = "block";

      if (event.archiveAfterFinish) {
        archiveContainer.appendChild(section);
        section.classList.remove("featured");
      }
      return;
    }

    daysEl.innerText = Math.floor(distance / (1000*60*60*24));
    hoursEl.innerText = Math.floor((distance % (1000*60*60*24)) / (1000*60*60));
    minutesEl.innerText = Math.floor((distance % (1000*60*60)) / (1000*60));
    secondsEl.innerText = Math.floor((distance % (1000*60)) / 1000);
  }

  updateCountdown();
  setInterval(updateCountdown, 1000);
}
</script>
</body>
</html>
